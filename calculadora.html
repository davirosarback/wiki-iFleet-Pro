<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" charset=utf-8 content="text/html; charset=iso-8859-1" />
  <link rel="stylesheet" href="style.css">
  <title>Calculadora de Bitrate - Intelbras</title>
 
  
</head>
<style>
	body{
		overflow: hidden;
		height: 100vh;
		background: linear-gradient(180deg, rgba(0,149,52,1) 12%, rgba(23,68,39,1) 100%, rgba(0,163,53,1) 100%, rgba(0,212,255,1) 100%);	}
	
</style>
<body>
	<div class="root-container">
		<div id="root">
			<table cellspacing=0 id=TB border-spacing=0 table-layout=fixed text-align=center  border="1">
				<tr><td nowrap colspan=9 class=Title>
					<div style="text-align:center"><b>Calculadora de Bitrate - Intelbras</b></a></div>
		
				<tr><td style=text-align:right nowrap colspan=2 class=tdTitle><b>Tamanho de Arquivo :</b> </td> <td id=TDResult colspan=5 style="color:rgb(0, 0, 0);">0 MB</td><td width=8% nowrap colspan=1 class=tdTitle><button id=bAddChannel>Adicionar Canal</button></td> <td width=8% nowrap colspan=1 class=tdTitle><button id=bDellChannel>Remover Todos</button></td></tr>
				
				<tr>
					<td class=tdTitle width=2%><b>No.</b></td>
					<td class=tdTitle><b>Resolução (Cálculo)</b></td>
					<td class=tdTitle><b>PAL/NTSC</b></td>
					<td class=tdTitle><b>Qualidade</b></td>
					<td class=tdTitle><b>Frame (1-30)</b></td>
					<td class=tdTitle><b>Duração (hora)</b></td>			
					<td class=tdTitle><b>Rate (Kbps)</b></td>
					<td class=tdTitle><b>Tamanho</b></td>
					<td class=tdTitle><b>Canal</b></td>
				</tr>
			</table>
		</div>
	</div>

	<script type="text/javascript">	
		var base={
			rate:{
				QCIF:["512","448","416","384","352","320","288","256"],
				CIF:["1024","768","640","512","440","350","312","280"],
				HD1:["1536","1280","1024","768","640","560","500","450"],
				D1:["2048","1536","1280","1024","900","800","720","640"],
				WCIF:["1024*1.3","768*1.3","640*1.3","512*1.3","440*1.3","350*1.3","312*1.3","280*1.3"],
				WHD1:["1536*1.3","1280*1.3","1024*1.3","768*1.3","640*1.3","560*1.3","500*1.3","450*1.3"],
				WD1:["2048*1.3","1536*1.3","1280*1.3","1024*1.3","900*1.3","800*1.3","720*1.3","640*1.3"],
				P720:["6144","4800","4128","3456","2784","2112","1440","768"],
				P1080:["8192","6390","5505","4068","3712","2816","1919","1024"]
			},resolution:{
				QCIF:"(P176*144 / N160*120)",
				CIF:"(P352*288 / N352*240)",
				HD1:"(P704*288 / N704*240",
				D1:"(P704*576 / N704*480)",
				WCIF:"(P480*288 / N480*240)",
				WHD1:"(P960*288 / N960*240)",
				WD1:"(P960*576 / N960*480)",
				P720:"(1280*720)",
				P1080:"(1920*1080)"
			}
		};
		window.onload=function(){
			document.getElementById("bAddChannel").onclick=AddChannel;
			document.getElementById("bDellChannel").onclick=DellChannel;
		};	

		function AddChannel(){
			var r=document.getElementById("TB").insertRow(-1);
			var prer=document.getElementById("TB").rows[r.rowIndex-1];
			for(var i=0;i<9;i++) r.insertCell(-1);
			{//No. & size
				r.cells[7].style.cssText="color:red;";
				r.cells[0].innerText=r.rowIndex-2;
				
			};
			{//Resolution
				r.resolution=document.createElement("Select"); r.cells[1].appendChild(r.resolution);
				r.resolution.onchange=function(){
					this.resolutioncomm.innerText=base.resolution[this.options[this.selectedIndex].value];
					size();				
					
				};
				for(var k in base.resolution){
					var opt=document.createElement("OPTION"); r.resolution.add(opt);
					opt.value=k; opt.text=k;
				};
				r.resolution.resolutioncomm=document.createElement("LABEL");
				r.resolution.resolutioncomm.style.cssText="padding:2px;";
				r.cells[1].appendChild(r.resolution.resolutioncomm);
				r.resolution.resolutioncomm.innerText=base.resolution[r.resolution.options[r.resolution.selectedIndex].value];
				if(prer.resolution!=null)r.resolution.selectedIndex=prer.resolution.selectedIndex;
			};
			{//PAL/NTSC
				r.pn=document.createElement("Select"); r.cells[2].appendChild(r.pn);
				r.pn.onchange=size;
				r.pn.innerHTML="<option value=PAL>PAL</option>"
					+"<option value=NTSC>NTSC</option>";
				if(prer.pn!=null)r.pn.selectedIndex=prer.pn.selectedIndex;
			};
			{//Quality
				r.quality=document.createElement("Select"); r.cells[3].appendChild(r.quality);
				r.quality.onchange=size;
				for(var i=1;i<=8;i++){
					var opt=document.createElement("OPTION"); r.quality.add(opt);
					opt.value=opt.text=i;
				};
				if(prer.quality!=null)r.quality.selectedIndex=prer.quality.selectedIndex;
			};
			{//Frame
				r.frame=document.createElement("INPUT"); r.cells[4].appendChild(r.frame);
				r.frame.onchange=size;  r.frame.type="TEXT";
				r.frame.value=25;	r.frame.style.width="35px";
				if(prer.frame!=null)r.frame.value=prer.frame.value;
			};
			{//Duration
				r.duration=document.createElement("INPUT"); r.cells[5].appendChild(r.duration);
				r.duration.onchange=size;  r.duration.type="TEXT";
				r.duration.value=1;	r.duration.style.width="35px";			
				if(prer.duration!=null)r.duration.value=prer.duration.value;
			};			
			r.cells[6].innerText="0 b"; r.cells[7].innerText="0 MB";		
			{//RemoveChannel
				r.btn=document.createElement("BUTTON"); r.cells[8].appendChild(r.btn);
				r.btn.type="TEXT"; r.btn.innerText="Remover"; r.btn.row=r;
				r.btn.onclick=function(){
					document.getElementById("TB").deleteRow(this.row.rowIndex);
					for(var i=3;i<document.getElementById("TB").rows.length;i++){
						var rr=document.getElementById("TB").rows[i];
						rr.cells[0].innerText=rr.rowIndex-2;
					};
					size();
				};
			};
			
			size();
		};
		function size(){
			var resultall=0;
			for(var i=3;i<document.getElementById("TB").rows.length;i++){
				var r=document.getElementById("TB").rows[i];
				var resolution=r.resolution.options[r.resolution.selectedIndex].value;
				var pn=r.pn.options[r.pn.selectedIndex].value;
				var quality=r.quality.options[r.quality.selectedIndex].value;
				var frame=r.frame.value; var duration=r.duration.value;
				r.cells[6].innerText=resolution=base.rate[resolution][quality-1];
				var p=resolution.indexOf("*");
				if(p>0)resolution=resolution.substr(0,p)*resolution.substr(p+1);
				if(isNaN(frame)){
					alert("Please Input Frame (1-30) ! \r\n\r\nLine is : "+(i-2)); return;
				};
				frame=parseInt(frame);
				if(frame<1||frame>30){
					alert("Please Input Frame (1-30) ! \r\n\r\nLine is : "+(i-2)); return;
				};
				if(isNaN(duration)){
					alert("Please Input Duration (hour) ! \r\n\r\nLine is : "+(i-2)); return;
				};
				duration=parseInt(duration);
				if(duration<0){
					alert("Please Input Duration (hour>0) ! \r\n\r\nLine is : "+(i-2)); return;
				};
				var arg=1;
				if(pn=="PAL"){
					if(frame>=1&&frame<=5)arg=1.4;
					else if(frame>=6&&frame<=11)arg=1.3;
					else if(frame>=12&&frame<=17)arg=1.2;
					else if(frame>=18&&frame<=22)arg=1.1;
				}else if(pn=="NTSC"){
					if(frame>=1&&frame<=6)arg=1.4;
					else if(frame>=7&&frame<=14)arg=1.3;
					else if(frame>=15&&frame<=21)arg=1.2;
					else if(frame>=22&&frame<=27)arg=1.1;
				};
				var result=resolution*frame*arg*duration*3600/25;				
				resultall+=result;
				r.cells[7].innerText=formatsize(result);
			};
			document.getElementById("TDResult").innerText=formatsize(resultall);
		};
		function formatsize(num){
			if(num/8>1024*1024)num=Math.round(num*100/8/1024/1024)/100+" GB";
			else if(num/8>1024)num=Math.round(num*100/8/1024)/100+" MB";
			else num=Math.round(num*100/8)/100+" KB";
			return(num);
		};

		function DellChannel(TB){
			var r=document.getElementById("TB").rows;
			var i = 3;
			for (i= r.length-1; i!=2; i--){
					document.getElementById("TB").deleteRow(i);
			}
			size();
		}
		


  </script>	
</body>
</html>